(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{353:function(s,e,a){"use strict";a.r(e);var t=a(1),n=Object(t.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[s._v("简介")]),s._v(" "),e("p",[s._v("排查完全陌生的问题、完全不熟悉的系统组件，对于后端开发工程师来说是乐趣，当然也是挑战。今天借这篇文章，跟大家分析一例这样的问题。排查过程中，需要理解一些自己完全陌生的组件，比如 systemd 和 dbus。但是排查问题的思路和方法基本上还是可以复用了，希望对大家有所帮助。")])]),s._v(" "),e("h3",{attrs:{id:"主节点相关操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#主节点相关操作"}},[s._v("#")]),s._v(" 主节点相关操作")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("更改配置文件，重新加载\nsystemctl daemon-reload\n启动master相关组件\nsystemctl start kube-apiserver/kube-controller-manager/ube-scheduler/etcd.service\n停止master相关组件\nsystemctl stop kube-apiserver/kube-controller-manager/ube-scheduler/etcd.service\n重启master相关组件\nsystemctl restart kube-apiserver/kube-controller-manager/ube-scheduler/etcd.service\n查看master相关组件状态\nsystemctl status kube-apiserver/kube-controller-manager/ube-scheduler/etcd.service\n查看各组件信息\nkubectl get componentstatuses\n查看kubelet进程启动参数\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ef")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" kubelet\n查看日志:\njournalctl "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" kubelet "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("\n查看集群信息\nkubectl cluster-info\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])]),e("h3",{attrs:{id:"从节点相关操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#从节点相关操作"}},[s._v("#")]),s._v(" 从节点相关操作")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("启动worker端相关组件\nsystemctl start kube-proxy/docker/kubelet\n停止worker端相关组件\nsystemctl stop kube-proxy/docker/kubelet\n重启worker端相关组件\nsystemctl restart kube-proxy/docker/kubelet\n查看worker端相关组件状态\nsystemctl status kube-proxy/docker/kubelet\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br")])]),e("h3",{attrs:{id:"节点相关操作"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#节点相关操作"}},[s._v("#")]),s._v(" 节点相关操作")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("设为node为不可调度状态：\nkubectl cordon node1\n解除node不可调度状态\nkubectl uncordon node1\n将pod赶到其他节点：\nkubectl drain node1\nmaster运行pod\nkubectl taint nodes master.k8s node-role.kubernetes.io/master-\nmaster不运行pod\nkubectl taint nodes master.k8s node-role.kubernetes.io/master"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(":NoSchedule\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);